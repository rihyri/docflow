<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/layout}">
<head>
    <meta charset="UTF-8">
    <title>문서 업로드</title>
</head>
<div layout:fragment="content">
    <div>
        <h1>문서 업로드</h1>

        <div th:if="${error}">
            <p th:text="${error}"></p>
        </div>

        <form th:action="@{/documents/upload}" method="post" enctype="multipart/form-data">
            <input type="hidden" name="teamNo" th:value="${teamNo}">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">

            <div>
                <label>문서 제목</label>
                <input type="text" id="title" name="title" required maxlength="200" placeholder="문서 제목을 입력하세요.">
            </div>

            <div>
                <label>카테고리</label>
                <select id="category" name="category" required>
                    <option value="">카테고리 선택</option>
                    <option th:each="cat : ${categories}"
                            th:value="${cat}"
                            th:text="${cat.description}"></option>
                </select>
            </div>

            <div>
                <label>파일선택</label>
                <input type="file" id="file" name="file" required accept=".pdf,.doc,.docx,.txt,.hwp">
                <small>최대 10MB, PDF/DOC/DOCX/TXT/HWP 파일만 업로드 가능</small>
            </div>

            <div>
                <button type="submit">업로드</button>
                <a th:href="@{/documents/list(teamNo=${teamNo})}">취소</a>
            </div>
        </form>
    </div>
</div>

<script layout:fragment="script" th:inline="javascript">

    document.getElementById('file').addEventListener('change', function(e) {
        const file = e.target.files[0];
        if (file && file.size > 10 * 1024 * 1024) {
            alert('파일 크기는 10MB를 초과할 수 없습니다.');
            e.target.value = '';
        }
    });

</script>